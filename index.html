<!--<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DragGrid Demo</title>
  <link rel="shortcut icon" href="/img/favicon.svg" type="image/x-icon">
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      color: #333;
      background-color: #692f2f;
    }
    .header {
      background-color: #ffffff;
      color: #211f1f;
      padding: 15px 20px;
      border-radius: 5px;
      margin-bottom: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .draggrid-logo{
      color: #1a1a22 !important;
    }
    .d-flex{
      display: flex;
      align-items: center;
    }
    .header h1 {
      margin: 0;
      font-size: 24px;
    }
    .controls {
      margin-bottom: 20px;
      padding: 15px;
      background-color: #222222;
      color: #ccc;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .control-group {
      margin-bottom: 10px;
    }
    .button-group {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }
    button {
      padding: 8px 12px;
      background-color: #333;
      color: white;
      border: 1px solid #444;
      box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      transition: background-color 0.3s;
    }
    button:hover {
      background-color: #fff;
      color: #333;
    }
    button.secondary {
      background-color: #2196F3;
    }
    button.secondary:hover {
      background-color: #0b7dda;
    }
    button.danger {
      background-color: #f44336;
    }
    button.danger:hover {
      background-color: #d32f2f;
    }
    .grid-container {
      width: 100%;
      min-height: 600px;
      border: 1px solid #242222;
      background-color: #fafafa;
      border-radius: 5px;
      margin-bottom: 1.5rem;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.5);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s, visibility 0.3s;
    }
    .modal-overlay.active {
      opacity: 1;
      visibility: visible;
    }
    .modal-content {
      background-color: #222222;
      color: #fff;
      border-radius: 8px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      width: 100%;
      max-width: 500px;
      transform: translateY(-20px);
      transition: transform 0.3s;
    }
    .modal-overlay.active .modal-content {
      transform: translateY(0);
    }
    .modal-header {
      padding: 15px 20px;
      border-bottom: 1px solid #444;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .modal-header h3 {
      margin: 0;
      font-size: 18px;
    }
    .modal-close {
      background: none;
      width: 40px;
      border: 1px solid #444;
      box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
      font-size: 20px;
      color: #777;
      cursor: pointer;
      padding: 0;
    }
    .modal-body {
      padding: 20px;
    }
    .modal-footer {
      padding: 15px 20px;
      border-top: 1px solid #444;
      text-align: right;
    }
    /* Fin de estilos del modal */
    
    .form-group {
      margin-bottom: 15px;
    }
    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }
    input, select, textarea {
      width: 100%;
      padding: 8px;
      box-sizing: border-box;
      border: 1px solid #444;
      box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
      border-radius: 4px;
      background: #211f1f;
      color: #fff;
    }
    .notifications {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
    }
    .notification {
      padding: 12px 20px;
      margin-bottom: 10px;
      border-radius: 4px;
      color: white;
      box-shadow: 0 3px 6px rgba(0,0,0,0.16);
      animation: fadeIn 0.3s, fadeOut 0.5s 3s forwards;
    }
    .notification.success {
      background-color: #4CAF50;
    }
    .notification.error {
      background-color: #f44336;
    }
    .notification.info {
      background-color: #2196F3;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    @keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; }
    }
    /* Estilos adicionales para la cuadrícula */
    .drag-grid-item {
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    .widget-content {
      padding: 10px;
      height: calc(100% - 38px); /* Ajustar por la altura del header */
      overflow: auto;
    }
    .status-bar {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 8px 20px;
      background-color: #f5f5f5;
      border-top: 1px solid #ddd;
      font-size: 14px;
      color: #666;
      display: flex;
      justify-content: space-between;
      z-index: 1000;
    }
    .toggle-switch {
      display: inline-flex;
      align-items: center;
      margin-right: 15px;
    }
    .toggle-switch label {
      margin-right: 5px;
    }
    .switch {
      position: relative;
      display: inline-block;
      width: 40px;
      height: 24px;
    }
    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: .4s;
      border-radius: 34px;
    }
    .slider:before {
      position: absolute;
      content: "";
      height: 16px;
      width: 16px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }
    input:checked + .slider {
      background-color: #1e9d22;
    }
    input:checked + .slider:before {
      transform: translateX(16px);
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="d-flex">
      <img src="/img/logo.png" width="40" height="40" alt="DragGrid logo">
      <h1 class="draggrid-logo">DragGrid</h1>
    </div>
    <div id="last-saved">Última actualización: Nunca</div>
  </div>
  
  <div class="controls">
    <div class="control-group">
      <h3>Controls</h3>
      <div class="button-group">
        <button id="add-widget">Add Widget</button>
        <button id="clear-grid" class="danger">Clear Grid</button>
        <button id="save-grid" class="secondary">Save Status</button>
        <button id="load-grid" class="secondary">Load Status</button>
      </div>
    </div>
    
    <div class="control-group">
      <div class="toggle-switch">
        <label for="drag-toggle">Slider:</label>
        <label class="switch">
          <input type="checkbox" id="drag-toggle" checked>
          <span class="slider"></span>
        </label>
      </div>
      
      <div class="toggle-switch">
        <label for="resize-toggle">Resize:</label>
        <label class="switch">
          <input type="checkbox" id="resize-toggle" checked>
          <span class="slider"></span>
        </label>
      </div>
      
      <div class="toggle-switch">
        <label for="remove-toggle">Delete:</label>
        <label class="switch">
          <input type="checkbox" id="remove-toggle" checked>
          <span class="slider"></span>
        </label>
      </div>

      <div class="toggle-switch">
        <label for="swappable-toggle">Swappable:</label>
        <label class="switch">
          <input type="checkbox" id="swappable-toggle" checked>
          <span class="slider"></span>
        </label>
      </div>
      
      
      <div class="toggle-switch">
        <label for="autosave-toggle">Auto save:</label>
        <label class="switch">
          <input type="checkbox" id="autosave-toggle">
          <span class="slider"></span>
        </label>
      </div>
    </div>
  </div>
  

  <div id="widget-modal" class="modal-overlay">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Configuration Widget</h3>
        <button class="modal-close" id="close-modal">&times;</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="widget-x">Axis X:</label>
          <input type="number" id="widget-x" min="0" max="11" value="0">
        </div>
        <div class="form-group">
          <label for="widget-y">Axis Y:</label>
          <input type="number" id="widget-y" min="0" value="0">
        </div>
        <div class="form-group">
          <label for="widget-width">Width:</label>
          <input type="number" id="widget-width" min="1" max="12" value="3">
        </div>
        <div class="form-group">
          <label for="widget-height">Height:</label>
          <input type="number" id="widget-height" min="1" max="10" value="2">
        </div>
        <div class="form-group">
          <label for="widget-title">Title:</label>
          <input type="text" id="widget-title" value="Nuevo Widget">
        </div>
        <div class="form-group">
          <label for="widget-content">Content:</label>
          <textarea id="widget-content" rows="4"></textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button id="cancel-widget" class="secondary">Cancel</button>
        <button id="create-widget">Add</button>
      </div>
    </div>
  </div>
  
  <div id="grid" class="grid-container"></div>
  
  
  <div id="notifications" class="notifications"></div>
  <div class="status-bar ">
    <div id="grid-status">Widgets: 0</div>
    <div>© 2025 DragGrid - By Juan Sueldo</div>
    <div id="save-status"></div>
  </div>


  <script src="/js/draggrid.js"></script>

  <script>
    // Configuración de la API (simulación)
    const API_CONFIG = {
      saveUrl: '/api/save-grid', // URL simulada para guardar datos
      loadUrl: '/api/load-grid'  // URL simulada para cargar datos
    };
    
    // Función para mostrar notificaciones
    function showNotification(message, type = 'info') {
      const notifications = document.getElementById('notifications');
      const notification = document.createElement('div');
      notification.className = `notification ${type}`;
      notification.textContent = message;
      notifications.appendChild(notification);
      
      // Eliminar después de 4 segundos
      setTimeout(() => {
        notification.remove();
      }, 4000);
    }
    
    // Función para actualizar la información de estado
    function updateStatus() {
      const gridStatus = document.getElementById('grid-status');
      gridStatus.textContent = `Widgets: ${grid.items.length}`;
    }
    
    // Actualizar timestamp de guardado
    function updateSavedTime() {
      const lastSaved = document.getElementById('last-saved');
      const now = new Date();
      const timeStr = now.toLocaleTimeString();
      lastSaved.textContent = `Última actualización: ${timeStr}`;
    }
    
    // Simular operaciones de API
    const apiService = {
      // Simular guardar en el servidor
      saveGrid: function(data) {
        return new Promise((resolve, reject) => {
          // Simular una demora de red
          setTimeout(() => {
            // Guardar en localStorage como simulación
            try {
              localStorage.setItem('DragGridData', JSON.stringify(data));
              resolve({ success: true, message: 'Datos guardados correctamente' });
            } catch (error) {
              reject({ success: false, message: 'Error al guardar datos' });
            }
          }, 800);
        });
      },
      
      // Simular cargar desde el servidor
      loadGrid: function() {
        return new Promise((resolve, reject) => {
          // Simular una demora de red
          setTimeout(() => {
            try {
              const data = localStorage.getItem('DragGridData');
              if (data) {
                resolve({ success: true, data: JSON.parse(data) });
              } else {
                resolve({ success: true, data: [] });
              }
            } catch (error) {
              reject({ success: false, message: 'Error al cargar datos' });
            }
          }, 800);
        });
      }
    };

    // Inicializar la cuadrícula
    const grid = new DragGrid('#grid', {
      columns: 12,
      rowHeight: 60,
      margin: 5,
      draggable: true,
      resizable: true,
      removable: true,
      animate: true,
      swappable: true
    });

    // Elementos DOM
    const addWidgetBtn = document.getElementById('add-widget');
    const clearGridBtn = document.getElementById('clear-grid');
    const saveGridBtn = document.getElementById('save-grid');
    const loadGridBtn = document.getElementById('load-grid');
    const modal = document.getElementById('widget-modal');
    const createWidgetBtn = document.getElementById('create-widget');
    const cancelWidgetBtn = document.getElementById('cancel-widget');
    const closeModalBtn = document.getElementById('close-modal');
    const dragToggle = document.getElementById('drag-toggle');
    const resizeToggle = document.getElementById('resize-toggle');
    const removeToggle = document.getElementById('remove-toggle');
    const swappableToggle = document.getElementById('swappable-toggle');
    
    const autosaveToggle = document.getElementById('autosave-toggle');
    const saveStatus = document.getElementById('save-status');

    // Funciones para manejar el modal
    function openModal() {
      modal.classList.add('active');
    }
    
    function closeModal() {
      modal.classList.remove('active');
    }

    // Registrar evento onChange de la cuadrícula
    grid.onChange(function(data) {
      updateStatus();
      
      // Si el autosave está activado, guardar los cambios
      if (autosaveToggle.checked) {
        saveStatus.textContent = 'Guardando...';
        
        apiService.saveGrid(data)
          .then(response => {
            saveStatus.textContent = 'Guardado automático';
            updateSavedTime();
          })
          .catch(error => {
            saveStatus.textContent = 'Error al guardar';
            showNotification('Error al guardar automáticamente', 'error');
          });
      }
    });

    // Mostrar formulario para agregar widget en modal
    addWidgetBtn.addEventListener('click', () => {
      // Obtener un espacio vacío para sugerir posición
      const emptySpace = grid.findEmptySpace(3, 2);
      document.getElementById('widget-x').value = emptySpace.x;
      document.getElementById('widget-y').value = emptySpace.y;
      
      openModal();
    });

    // Cerrar modal al hacer clic en cancelar
    cancelWidgetBtn.addEventListener('click', closeModal);
    
    // Cerrar modal al hacer clic en la X
    closeModalBtn.addEventListener('click', closeModal);
    
    // Cerrar modal al hacer clic fuera de él
    modal.addEventListener('click', function(e) {
      if (e.target === modal) {
        closeModal();
      }
    });

    // Crear widget
    createWidgetBtn.addEventListener('click', () => {
      const x = parseInt(document.getElementById('widget-x').value);
      const y = parseInt(document.getElementById('widget-y').value);
      const width = parseInt(document.getElementById('widget-width').value);
      const height = parseInt(document.getElementById('widget-height').value);
      const title = document.getElementById('widget-title').value;
      const content = document.getElementById('widget-content').value;
      
      // Crear el widget
      grid.addWidget({
        x: x,
        y: y,
        width: width,
        height: height,
        content: `
          <div class="widget-content">
            ${content}
          </div>
        `,
        id: `widget-${Date.now()}`,
        title: title
      });
      
      // Cerrar el modal
      closeModal();
      
      // Mostrar notificación
      showNotification('Widget creado con éxito', 'success');
      
      // Actualizar estado
      updateStatus();
    });

    // Limpiar cuadrícula
    clearGridBtn.addEventListener('click', () => {
      if (confirm('¿Estás seguro de que quieres limpiar la cuadrícula?')) {
        grid.clear();
        showNotification('Cuadrícula limpiada', 'info');
        updateStatus();
      }
    });

    // Guardar estado
    saveGridBtn.addEventListener('click', () => {
      const data = grid.serialize();
      saveStatus.textContent = 'Guardando...';
      
      apiService.saveGrid(data)
        .then(response => {
          showNotification('Estado guardado con éxito', 'success');
          saveStatus.textContent = 'Guardado manual';
          updateSavedTime();
        })
        .catch(error => {
          showNotification('Error al guardar el estado', 'error');
          saveStatus.textContent = 'Error al guardar';
        });
    });

    // Cargar estado
    loadGridBtn.addEventListener('click', () => {
      saveStatus.textContent = 'Cargando...';
      
      apiService.loadGrid()
        .then(response => {
          if (response.data && response.data.length > 0) {
            grid.load(response.data);
            showNotification('Estado cargado con éxito', 'success');
            updateStatus();
          } else {
            showNotification('No hay datos guardados para cargar', 'info');
          }
          saveStatus.textContent = '';
        })
        .catch(error => {
          showNotification('Error al cargar el estado', 'error');
          saveStatus.textContent = 'Error al cargar';
        });
    });

    // Toggle de arrastrar
    dragToggle.addEventListener('change', () => {
      grid.enableDragging(dragToggle.checked);
      showNotification(`Arrastrar ${dragToggle.checked ? 'activado' : 'desactivado'}`, 'info');
    });

    // Toggle de redimensionar
    resizeToggle.addEventListener('change', () => {
      grid.enableResizing(resizeToggle.checked);
      showNotification(`Redimensionar ${resizeToggle.checked ? 'activado' : 'desactivado'}`, 'info');
    });

    // Toggle de eliminar
    removeToggle.addEventListener('change', () => {
      grid.enableRemoving(removeToggle.checked);
      showNotification(`Eliminar ${removeToggle.checked ? 'activado' : 'desactivado'}`, 'info');
    });

    swappableToggle.addEventListener('change', () => {
      grid.enableSwap(swappableToggle.checked);
      showNotification(`Intercambio ${swappableToggle.checked ? 'activado' : 'desactivado'}`, 'info');
    });

    // Toggle de autosave
    autosaveToggle.addEventListener('change', () => {
      if (autosaveToggle.checked) {
        showNotification('Guardado automático activado', 'info');
        saveStatus.textContent = 'Autoguardado activo';
      } else {
        showNotification('Guardado automático desactivado', 'info');
        saveStatus.textContent = '';
      }
    });

    const initialWidgets = [
      { id:1, x: 0,  y: 0,  width: 4,  height: 3,  content: "",  title: "1"},
      { id:2, x: 4,  y: 0,  width: 3,  height: 3,  content: "",  title: "2"},
      { id:3, x: 7,  y: 0,  width: 3,  height: 3,  content: "",   title: "3"},
      { id:4, x: 10, y: 0,  width: 2,  height: 10, content: "",  title: "4"},
      { id:5, x: 0,  y: 3,  width: 7,  height: 7,  content: "",   title: "5"},
      { id:6, x: 7,  y: 3,  width: 3,  height: 7,  content: "",   title: "6"},
    ]
    // Agregar algunos widgets iniciales para demostración
    window.addEventListener('DOMContentLoaded', () => {
      // Intentar cargar datos guardados
      apiService.loadGrid()
        .then(response => {
          if (response.data && response.data.length > 0) {
            grid.load(response.data);
            updateStatus();
            showNotification('Datos cargados de la sesión anterior', 'info');
          } else {
            // Cargar widgets de demostración si no hay datos guardados
            // Widget 1
            initialWidgets.forEach((element)=>{
              grid.addWidget({
                id: element.id,
                x: element.x,
                y: element.y,
                width: element.width,
                height: element.height,
                title: element.title,
                content: element.content
              });
            })
           
            updateStatus();
          }
        })
        .catch(() => {
          // En caso de error, cargar widgets de demostración
          showNotification('No se pudieron cargar datos guardados', 'error');
          
          // Widget de demostración
          grid.addWidget({
            x: 0,
            y: 0,
            width: 6,
            height: 3,
            content: `
              <div class="widget-content">
                <h3>Bienvenido a DragGrid</h3>
                <ul>
                  <li>Arrastrar y soltar widgets</li>
                  <li>Redimensionar widgets</li>
                  <li>Guardar y cargar layouts</li>
                  <li>Actualización mediante AJAX/fetch</li>
                </ul>
              </div>
            `
          });
          
          updateStatus();
        });
    });

    // Manejar el cierre de la ventana para guardar estado
    window.addEventListener('beforeunload', () => {
      const data = grid.serialize();
      localStorage.setItem('DragGridData', JSON.stringify(data));
    });

    // Función para simular el endpoint para guardar la cuadrícula
    async function handleFetch(url, options) {
      if (url === API_CONFIG.saveUrl) {
        try {
          const data = JSON.parse(options.body);
          localStorage.setItem('DragGridData', JSON.stringify(data));
          return { ok: true, json: () => Promise.resolve({ success: true }) };
        } catch (error) {
          return { ok: false, json: () => Promise.reject({ success: false }) };
        }
      } else if (url === API_CONFIG.loadUrl) {
        try {
          const data = localStorage.getItem('DragGridData');
          return { 
            ok: true, 
            json: () => Promise.resolve({ success: true, data: data ? JSON.parse(data) : [] }) 
          };
        } catch (error) {
          return { ok: false, json: () => Promise.reject({ success: false }) };
        }
      }
      
      return { ok: false };
    }

    // Sobrescribir fetch para simular API
    const originalFetch = window.fetch;
    window.fetch = function(url, options) {
      // Si es una de nuestras URLs simuladas
      if (url === API_CONFIG.saveUrl || url === API_CONFIG.loadUrl) {
        return new Promise((resolve) => {
          // Simular latencia de red
          setTimeout(() => {
            resolve(handleFetch(url, options));
          }, 800);
        });
      }
      
      // Caso contrario, usar fetch original
      return originalFetch(url, options);
    }
    grid.items.forEach(item => {
  item.el.addEventListener('click', (e) => {
    if (e.ctrlKey || e.metaKey) {  // Con tecla Control/Cmd
      const isSelected = item.el.classList.contains('widget-selected');
      grid.selectWidget(item.el, !isSelected);
      
      if (!isSelected) {
        selectedWidgets.push(item.el);
        if (selectedWidgets.length === 2) {
          // Intercambiar los dos widgets seleccionados
          grid.swapWidgets(selectedWidgets[0], selectedWidgets[1]);
          
          // Limpiar selección
          selectedWidgets.forEach(widget => grid.selectWidget(widget, false));
          selectedWidgets = [];
        }
      } else {
        // Quitar de la selección
        selectedWidgets = selectedWidgets.filter(w => w !== item.el);
      }
    }
  });
});
  </script>
</body>
</html>
-->


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DragGrid</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
</head>
<style>
   
    body {
      font-family: Arial, sans-serif;
      color: #fff;
      background-color: #030712;
    }
    .version{
        font-family: 'Courier New', Courier, monospace;
        font-size: 0.75rem;
        opacity: 0.6;
    }
    .subtitle{
        font-size: 0.9rem;
        opacity: 0.7;
    }
    .grid-container{
        width: 100%;
        min-height: 600px;
        border-radius: 5px;
        margin-bottom: 1.5rem;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        background-color: rgba(5, 18, 58, 0.955) !important;
    }
    .drag-grid-drag-handle{
        background: rebeccapurple;
    }
    .drag-grid-item-content {
        background: rebeccapurple;
    }

    /* Estilos para el contenedor de alertas */
    .alerts-container {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1000;
        max-width: 400px;
        pointer-events: none;
    }

    .alert {
        pointer-events: auto;
        margin-bottom: 10px;
        transform: translateX(100%);
        opacity: 0;
        transition: all 0.3s ease-in-out;
    }

    .alert.show {
        transform: translateX(0);
        opacity: 1;
    }

    .alert.hide {
        transform: translateX(100%);
        opacity: 0;
    }
    .bg-custom-dark {
      background-color: #030712;
    }


</style>
<body>
    <!-- Contenedor de alertas -->
    <div id="alerts-container" class="alerts-container"></div>

    <header class="flex flex-col w-full items-center justify-center p-4">
        <span class="version">v.1.0.0</span>
        <h1 class="text-3xl font-bold">DragGrid</h1>
        <h5 class="subtitle">A simple library for creating and managing resizable widgets on any web page.</h5>
        <div class="mt-10 px-4 sm:px-0"> <span class="mb-4 text-xs font-medium opacity-60">Download the dependency</span>
        <div class="flex w-full max-w-md items-center justify-between gap-x-2 rounded-md bg-gray-800 py-1 pl-4 pr-1 text-center backdrop-blur" > 
            <pre class="flex text-sm">
            <pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="plaintext"><code><span class="line"><a href="https://github.com/juansueldo/draggrid" target="_blank">https://github.com/juansueldo/draggrid</a></span></code></pre>
            </pre> 
            <button id="copyNpmInstall" aria-label="Copy npm install command" title="Copy" class="my-1 mr-2 inline-flex size-7 items-center justify-center cursor-pointer whitespace-nowrap rounded-full bg-gray-950/60 text-sm font-medium text-gray-100 transition focus-visible:outline-none disabled:pointer-events-none" data-astro-cid-j7pv25f6=""> <svg width="16" height="16" stroke-width="1.5" viewBox="0 0 24 24" fill="none"><path d="M19.4 20H9.6C9.26863 20 9 19.7314 9 19.4V9.6C9 9.26863 9.26863 9 9.6 9H19.4C19.7314 9 20 9.26863 20 9.6V19.4C20 19.7314 19.7314 20 19.4 20Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M15 9V4.6C15 4.26863 14.7314 4 14.4 4H4.6C4.26863 4 4 4.26863 4 4.6V14.4C4 14.7314 4.26863 15 4.6 15H9" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg> </button> </div>
        </div>

    </header>
    <section class=" left-0 top-0 z-50 mb-8 flex flex-col items-center justify-center gap-4 px-6 py-2 sm:gap-6" id="option-inputs">
        <div class="buttons flex flex-wrap items-center justify-center gap-4 px-6 py-2 sm:gap-6">
            <button class="px-4 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition" id="add-widget" onclick="document.getElementById('modal').classList.remove('hidden')">Add Widget</button>
            <button class="px-4 py-1 bg-red-600 text-white rounded-lg hover:bg-red-700 transition" id="clear-grid">Clear Grid</button>
            <button class="px-4 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition" id="save-status">Save Status</button>
            <button class="px-4 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition" id="load-status">Load Status</button>
        </div>
        <div class="selects flex flex-wrap items-center justify-center gap-4 px-6 py-2 sm:gap-6">

            <div class="mt-4">
                <label class="block font-mono text-xs font-medium text-gray-800 dark:text-gray-200">Slider</label>
                <select name="slider" id="slider" class="mt-1 block w-full min-w-32 rounded-lg border border-gray-200 bg-gray-50 p-2 text-xs placeholder-opacity-80 dark:border-gray-700 dark:bg-gray-900" data-astro-cid-j7pv25f6=""> 
                    <option value="true">Yes</option>
                    <option value="false">No</option>
                </select>
            </div>
            <div class="mt-4">
                <label class="block font-mono text-xs font-medium text-gray-800 dark:text-gray-200">Resize</label>
                <select name="resize-toggle" id="resize-toggle" class="mt-1 block w-full min-w-32 rounded-lg border border-gray-200 bg-gray-50 p-2 text-xs placeholder-opacity-80 dark:border-gray-700 dark:bg-gray-900" data-astro-cid-j7pv25f6=""> 
                    <option value="true">Yes</option>
                    <option value="false">No</option>
                </select>
            </div>
            <div class="mt-4">
                <label class="block font-mono text-xs font-medium text-gray-800 dark:text-gray-200">Delete</label>
                <select name="remove-toggle" id="remove-toggle" class="mt-1 block w-full min-w-32 rounded-lg border border-gray-200 bg-gray-50 p-2 text-xs placeholder-opacity-80 dark:border-gray-700 dark:bg-gray-900" data-astro-cid-j7pv25f6=""> 
                    <option value="true">Yes</option>
                    <option value="false">No</option>
                </select>
            </div>
                <div class="mt-4">
                <label class="block font-mono text-xs font-medium text-gray-800 dark:text-gray-200">Swappable</label>
                <select name="swappable-toggle" id="swappable-toggle" class="mt-1 block w-full min-w-32 rounded-lg border border-gray-200 bg-gray-50 p-2 text-xs placeholder-opacity-80 dark:border-gray-700 dark:bg-gray-900" data-astro-cid-j7pv25f6=""> 
                    <option value="true">Yes</option>
                    <option value="false">No</option>
                </select>
            </div>
        </div>
        
    </section>
    <div class="px-4">
        <div id="grid" class="grid-container"></div>
    </div>
    <div id="modal" class="fixed inset-0 bg-custom-dark bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-md w-full" style="background-color: rgba(23, 32, 57, 0.27) !important;">
            <h2 class="text-lg font-semibold mb-4 text-gray-800 dark:text-white">Add Widget</h2>

            <div class="modal-body space-y-4">
                
                <div class="form-group">
                    <label for="widget-width" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Width:</label>
                    <input type="number" id="widget-width" min="1" max="12" value="3"
                    class="mt-1 w-full rounded-md border-gray-300 border border-gray-200 bg-gray-50 p-2 text-xs placeholder-opacity-80 dark:border-gray-700 dark:bg-gray-900 dark:text-white shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 dark:focus:ring-blue-400 focus:outline-none" />
                </div>

                <div class="form-group">
                    <label for="widget-height" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Height:</label>
                    <input type="number" id="widget-height" min="1" max="10" value="2"
                    class="mt-1 w-full rounded-md border-gray-300 border border-gray-200 bg-gray-50 p-2 text-xs placeholder-opacity-80 dark:border-gray-700 dark:bg-gray-900 dark:text-white shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 dark:focus:ring-blue-400 focus:outline-none" />
                </div>

                <div class="form-group">
                    <label for="widget-title" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Title:</label>
                    <input type="text" id="widget-title" value="Nuevo Widget"
                    class="mt-1 w-full rounded-md border-gray-300 border border-gray-200 bg-gray-50 p-2 text-xs placeholder-opacity-80 dark:border-gray-700 dark:bg-gray-900 dark:text-white shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 dark:focus:ring-blue-400 focus:outline-none" />
                </div>

                <div class="form-group">
                    <label for="widget-content" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Content:</label>
                    <textarea id="widget-content" rows="4"
                    class="mt-1 w-full rounded-md border border-gray-200 bg-gray-50 p-2 text-xs placeholder-opacity-80 dark:border-gray-700 dark:bg-gray-900 dark:text-white shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 dark:focus:ring-blue-400 focus:outline-none"></textarea>
                </div>
            </div>
            
            <div class="flex justify-end gap-2 mt-4">
            <button
                class="px-4 py-2 bg-gray-300 rounded hover:bg-gray-400 dark:bg-gray-700 dark:hover:bg-gray-600"
                onclick="document.getElementById('modal').classList.add('hidden')"
            >
                Cancel
            </button>
            <button class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700" id="create-widget" onclick="document.getElementById('modal').classList.add('hidden')">Save</button>
            </div>
        </div>
    </div>
     <footer class="mt-8 text-center text-sm text-gray-500 dark:text-gray-400">
  Created by 
  <a href="https://juansueldo.dev" target="_blank" class="text-blue-600 hover:underline dark:text-blue-400">
    Juan Sueldo
  </a>
</footer>

     <script src="/js/draggrid.js"></script>
     <script>
// Función para mostrar alertas personalizadas
function showAlert(message, type = 'info', duration = 4000) {
    const alertsContainer = document.getElementById('alerts-container');
    const alertId = 'alert-' + Date.now();
    
    // Colores según el tipo
    const typeClasses = {
        success: 'text-green-800 bg-green-50 dark:bg-gray-800 dark:text-green-400',
        error: 'text-red-800 bg-red-50 dark:bg-gray-800 dark:text-red-400',
        warning: 'text-yellow-800 bg-yellow-50 dark:bg-gray-800 dark:text-yellow-400',
        info: 'text-blue-800 bg-blue-50 dark:bg-gray-800 dark:text-blue-400'
    };
    
    // Iconos según el tipo
    const typeIcons = {
        success: `<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
        </svg>`,
        error: `<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>
        </svg>`,
        warning: `<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
        </svg>`,
        info: `<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
        </svg>`
    };
    
    const alertElement = document.createElement('div');
    alertElement.id = alertId;
    alertElement.className = `alert bg-custom-dark p-4 text-sm rounded-lg shadow-lg ${typeClasses[type]} border border-opacity-20`;
    alertElement.innerHTML = `
        <div class="flex items-center">
            <div class="flex-shrink-0 mr-3">
                ${typeIcons[type]}
            </div>
            <div class="flex-1 flex flex-col">
                <span class="font-medium">${type.charAt(0).toUpperCase() + type.slice(1)}!</span>
                <span class="">${message}</span>
            </div>
            <button class="ml-4 text-current opacity-50 hover:opacity-100 transition-opacity" onclick="hideAlert('${alertId}')">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                </svg>
            </button>
        </div>
    `;
    
    alertsContainer.appendChild(alertElement);
    
    // Mostrar con animación
    setTimeout(() => {
        alertElement.classList.add('show');
    }, 100);
    
    // Auto-hide después del tiempo especificado
    setTimeout(() => {
        hideAlert(alertId);
    }, duration);
}

// Función para ocultar alertas
function hideAlert(alertId) {
    const alert = document.getElementById(alertId);
    if (alert) {
        alert.classList.add('hide');
        setTimeout(() => {
            alert.remove();
        }, 300);
    }
}

// Función para mostrar confirmación personalizada
function showConfirmation(message, onConfirm) {
    const confirmModal = document.createElement('div');
    confirmModal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
    confirmModal.innerHTML = `
        <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-md w-full mx-4" style="background-color: rgb(3, 7, 18, 1) !important;">
            <h3 class="text-lg font-semibold mb-4 text-gray-800 dark:text-white">Confirmar acción</h3>
            <p class="text-gray-600 dark:text-gray-300 mb-6">${message}</p>
            <div class="flex justify-end gap-2">
                <button class="px-4 py-2 bg-gray-300 rounded hover:bg-gray-400 dark:bg-gray-700 dark:hover:bg-gray-600" onclick="this.closest('.fixed').remove()">
                    Cancelar
                </button>
                <button class="px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700" onclick="this.closest('.fixed').remove(); (${onConfirm.toString()})()">
                    Confirmar
                </button>
            </div>
        </div>
    `;
    
    document.body.appendChild(confirmModal);
}

const clearGridBtn = document.getElementById('clear-grid');
const createWidgetBtn = document.getElementById('create-widget');
const addWidgetBtn = document.getElementById('add-widget');
const dragToggle = document.getElementById('slider');
const resizeToggle = document.getElementById('resize-toggle');
const removeToggle = document.getElementById('remove-toggle');
const swappableToggle = document.getElementById('swappable-toggle');
const saveStatus = document.getElementById('save-status');
const loadStatus = document.getElementById('load-status');

document.addEventListener("DOMContentLoaded", function() {
    const copyBtn = document.getElementById("copyNpmInstall");
    copyBtn.addEventListener("click", function() {
        // Obtiene el texto del <a> dentro del pre
        const linkText = document.querySelector("pre a").href;

        // Copia al portapapeles
        navigator.clipboard.writeText(linkText)
            .then(() => {
                console.log("Copiado al portapapeles:", linkText);
                showAlert("Link copied to clipboard", "success");
                copyBtn.title = "¡Copiado!";
                setTimeout(() => copyBtn.title = "Copy", 1500);
            })
            .catch(err => {
                console.error("Error al copiar:", err);
                showAlert("Error copying link", "error");
            });
    });
});

const grid = new DragGrid('#grid', {
    columns: 12,
    rowHeight: 60,
    margin: 5,
    draggable: true,
    resizable: true,
    removable: true,
    animate: true,
    swappable: true
});

function setContent(badges, text) {
    let html = '<div class="px-2">';
    badges.forEach((badge) => {
        html += `<span class="bg-${badge.color}-100 text-${badge.color}-800 text-sm font-medium me-2 px-2.5 py-0.5 rounded-sm dark:bg-${badge.color}-900 dark:text-${badge.color}-300">${badge.text}</span>`;
    });
    html += `<h6 class="mt-2">${text}</h6>`;
    html += '</div>';
    return html;
}

function setTile(title){
    return  `
    <div class='flex flex-col'>
        <h1 class='text-white'>${title}</h1>
    </div>
    `
}
 
const initialWidgets = [
    { 
        id: 1, 
        x: 0,  
        y: 0,  
        width: 2,  
        height: 2,  
        content: setContent([
            { color: 'orange', text: 'Marketing' },
            { color: 'indigo', text: 'External' }
        ], 'Plan marketing campaign'),  
        title: setTile('Upcoming')
    },
    { 
        id: 2, 
        x: 2,  
        y: 0,  
        width: 2,  
        height: 3,  
        content: setContent([
            { color: 'purple', text: 'Production' },
            { color: 'indigo', text: 'External' }
        ], 'Create 10 T-shirt options for launch day'), 
        title: setTile('In progress')
    },
    { 
        id: 3, 
        x: 4,  
        y: 0,  
        width: 2,  
        height: 2,  
        content: setContent([
            { color: 'blue', text: 'Sales' }
        ], 'Update online shop'),   
        title: setTile('Done')
    },
    { 
        id: 4, 
        x: 2, 
        y: 3,  
        width: 2,  
        height: 3, 
        content: setContent([
            { color: 'green', text: 'Legal' }
        ], 'Approve legal agreement'),   
        title: setTile('Upcoming')
    },
    { 
        id: 5, 
        x: 0,  
        y: 2,  
        width: 2,  
        height: 4,  
        content: setContent([
            { color: 'red', text: 'Finance' },
            { color: 'yellow', text: 'Review' }
        ], 'Prepare Q2 budget report'),   
        title: setTile('Review')
    },
    { 
        id: 6, 
        x: 6,  
        y: 0,  
        width: 3,  
        height: 4,  
        content: setContent([
            { color: 'pink', text: 'Design' }
        ], 'Sketch new homepage layout'),   
        title: setTile('In progress')
    },
    { 
        id: 7, 
        x: 9,  
        y: 4,  
        width: 3,  
        height: 2,  
        content: setContent([
            { color: 'blue', text: 'Sales' },
            { color: 'green', text: 'Client' }
        ], 'Follow up with top clients'),   
        title: setTile('Upcoming')
    },
    { 
        id: 8, 
        x: 4,  
        y: 2,  
        width: 2,  
        height: 5,  
        content: setContent([
            { color: 'indigo', text: 'External' },
            { color: 'purple', text: 'Production' }
        ], 'Arrange supplier contracts'),   
        title: setTile('Pending')
    },
    { 
        id: 9, 
        x: 6,  
        y: 4,  
        width: 3,  
        height: 3,  
        content: setContent([
            { color: 'orange', text: 'Marketing' }
        ], 'Plan social media calendar'),   
        title: setTile('Done')
    },
    { 
        id: 10, 
        x: 9,  
        y: 0,  
        width: 3,  
        height: 4,  
        content: setContent([
            { color: 'gray', text: 'Admin' }
        ], 'Clean up old database records'),   
        title: setTile('Cleanup')
    },
];

        
initialWidgets.forEach((element)=>{
    grid.addWidget({
        id: element.id,
        x: element.x,
        y: element.y,
        width: element.width,
        height: element.height,
        title: element.title,
        content: element.content
    });
});

clearGridBtn.addEventListener('click', () => {
    showConfirmation('Are you sure you want to clear the grid?', () => {
        grid.clear();
        showAlert('Grid cleaned successfully', 'success');
    });
});

createWidgetBtn.addEventListener('click', () => {
    const emptySpace = grid.findEmptySpace(3, 2);
    const width = parseInt(document.getElementById('widget-width').value);
    const height = parseInt(document.getElementById('widget-height').value);
    const title = document.getElementById('widget-title').value;
    const content = document.getElementById('widget-content').value;
    
    // Crear el widget
    grid.addWidget({
        x: emptySpace.x,
        y: emptySpace.y,
        width: width,
        height: height,
        content: `
        <div class="widget-content">
            ${content}
        </div>
        `,
        id: `widget-${Date.now()}`,
        title: title
    });
    
    showAlert('Widget created successfully', 'success');
});

dragToggle.addEventListener('change', (e) => {
    const isEnabled = e.target.value === 'true';
    grid.enableDragging(isEnabled);
    showAlert(`Drag ${isEnabled ? 'enabled' : 'disabled'}`, 'info');
});

resizeToggle.addEventListener('change', (e) => {
    const isEnabled = e.target.value === 'true';
    grid.enableResizing(isEnabled);
    showAlert(`Resize ${isEnabled ? 'enabled' : 'disabled'}`, 'info');
});

removeToggle.addEventListener('change', (e) => {
    const isEnabled = e.target.value === 'true';
    grid.enableRemoving(isEnabled);
    showAlert(`Remove ${isEnabled ? 'enabled' : 'disabled'}`, 'info');
});

swappableToggle.addEventListener('change', (e) => {
    const isEnabled = e.target.value === 'true';
    grid.enableSwap(isEnabled);
    showAlert(`Swap ${isEnabled ? 'enabled' : 'disabled'}`, 'info');
});

saveStatus.addEventListener('click', () => {
    const success = grid.saveToLocalStorage();
    if (!success) {
        showAlert('Error: Could not save to local storage. Check available space or browser permissions.', 'error');
    } else {
        showAlert('Settings saved successfully.', 'success');
    }
});

loadStatus.addEventListener('click', () => {
    try {
        const savedData = JSON.parse(localStorage.getItem('gridConfig'));
        if (savedData) {
            grid.load(savedData);
            showAlert('Configuration loaded successfully.', 'success');
        } else {
            showAlert('No saved configuration found.', 'warning');
        }
    } catch (error) {
        showAlert('Error loading configuration.', 'error');
    }});
     </script>
</body>
</html>
